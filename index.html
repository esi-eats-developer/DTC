<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Eland ESI(외식, 바이오헬스케어)">

        <!-- 본 웹에 대한 설명 -->
        <meta name="keywords" content=""/>
        <meta name="description" content=""> 

        <!-- 링크 공유 시 보여지는 내용 설정 -->
        <meta property="og:type" content="website"> 
        <meta property="og:title" content="">
        <meta property="og:description" content="">
        <meta property="og:image" content="">
        <meta property="og:url" rel="canonical" content="">

        <title>탭에 표시될 문구 설정</title>
        <!-- 탭에 표시되는 작은 아이콘 설정 -->
        <!-- <link rel="shortcut icon" href="./image/favicon.PNG">  -->

        <!-- 웹 디자인 -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link rel="stylesheet" href="style.css">

        <!-- 웹 개발에 응용되는 cdn 및 javascript 파일 -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    
        <!-- 카카오 메시지 API 사용을 위한 설정 -->
        <script src="//developers.kakao.com/sdk/js/kakao.min.js"></script>
        <script>Kakao.init('cfc81e62495a8be34ee51bcc44f563bf');</script>
        <script type="text/javascript">
            $(document).ready(function(){
                $(document).bind('keydown',function(e){
                    if ( e.keyCode == 123) {
                        e.preventDefault();
                        e.returnValue = false;
                    }
                });
            });
    
            document.onmousedown=disableclick;
    
            function disableclick(event){
                if (event.button==2) {
                    return false;
                }
            }
        </script>
    </head>

    <body class="container-fluid">
        <!-- 설문 시작 전 메인 페이지 -->
        <article class="start container-fluid mt-5 text-center">
            <div class="survey-start">
                <div class="start-header">
                    <!-- 로고 삽입 가능 -->
                    <span class="icon"></span> 
                    <h2>
                        <span>건강기능식품 큐레이션 서비스</span>
                        <br>
                        선물용 맞춤 상품
                    </h2>
                </div>
                <div class="start-info mt-5">
                    <p>
                    몇 가지 질문에 답하고 
                    <br>
                    특별한 선물을 위한 맞춤 상품을 추천 받아요!
                    <br>
                    <br>
                    <span>약 2분 정도 소요됩니다.</span>
                    </p>
                    <div class="btn-wrap">
                        <a href="#" id="btn-start" class="btn btn-radius btn-dark mt-5" onclick="start();">시작하기</a>
                        <p class="warning mt-2">* 질병의 진단 및 치료는 전문적인 의료기관을 이용하세요.</p>
                    </div>
                </div>
            </div>
        </article>

        <!-- 설문 페이지 -->
        <article class="survey container-fluid mt-5">
            <div class="survey-wrap">
                <div class="survey-contents">
                    <div class="survey-test">
                        <!-- 설문 진행 단계를 보여주는 파트 - 선물 추천용에서는 필요하지 않을 수 있음 -->
                        <!-- <nav class="survey-test-header">
                            <ul class="step-list-wrap">
                                <li data="기본정보">
                                    <span>기본정보</span>
                                    ::after
                                </li>
                                <li data="증상/불편">
                                    <span>증상/불편</span>
                                    ::after
                                </li>
                                <li data="생활 습관">
                                    <span>생활 습관</span>
                                    ::after
                                </li>
                                <li data="기타">
                                    <span>기타</span>
                                    ::after
                                </li>
                            </ul>
                        </nav> -->
                        <!-- 프로그레스바 -->
                        <div class="progress survey-progress">
                            <div id="survey-progress-rate" class="progress-bar" role="progressbar" style="width: calc(100/4*1%);" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <!-- 질문&답변 -->
                        <div class="survey-question-contents">
                            <section class="question-section">
                                <div>
                                    <!-- 질문 번호 -->
                                    <p id="qNum" class="mt-5">질문 1</p>
                                    <!-- 질문 -->
                                    <h2 id="qTitle" class="text-center">
                                        <p>질문</p>
                                        <span></span>
                                    </h2>
                                    <p id="qContent"></p>
                                </div>
                                <!-- 답변 -->
                                <div class="question-answer-wrap mt-5 text-center">
                                    <div class="question-answer-input">
                                        <input type="text" class="form-control name" placeholder="이름">
                                    </div>
                                    <div class="question-answer-selection">
                                        <div class="question-input-field">
                                            <div id="A" class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="question-answer" value="selection1">
                                                <label class="form-check-label" id="selection1" for="selection1">선택 1</label>
                                            </div>
                                            <div id="B" class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="question-answer" value="selection2">
                                                <label class="form-check-label" id="selection2" for="selection2">선택 2</label>
                                            </div>
                                            <div id="C" class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="question-answer" value="selection3">
                                                <label class="form-check-label" id="selection3" for="selection3">선택 3</label>
                                            </div>
                                            <div id="D" class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="question-answer" value="selection4">
                                                <label class="form-check-label" id="selection4" for="selection4">선택 4</label>
                                            </div>
                                            <div id="E" class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="question-answer" value="selection5">
                                                <label class="form-check-label" id="selection5" for="selection5">선택 5</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                    <!-- 에러 메시지 -->
                    <div class="survey-errormsg mt-2" style="display: none;">※ 응답을 입력해주세요!</div>
                    <!-- 하단 구성 -->
                    <div class="survey-question-footer mt-5">
                        <!-- <button id="btn-prev" class="btn btn-radius">이전</button> -->
                        <button id="btn-next" class="btn btn-radius btn-dark">다음</button>
                    </div>
                </div>
            </div>
        </article>

        <!--  마지막 페이지 -->
        <article class="result container-fluid">
            <div class="result-wrap">
                <div class="result-content">
                    <div class="result-info mt-5">
                        #<span class="sex">성별</span> #<span class="age">연령</span>
                        <br>
                        <h2 class="mt-2">
                            <span class="name">이름</span>님을 위한
                            <span style="color: blue;">'</span><span class="category" style="color: blue;">카테고리</span><span style="color: blue;">' 카테고리</span> 맞춤 선물이 준비되어 있어요!
                        </h2>
                        <img id="result-category-products" class="img-fluid mx-auto d-block mt-2" src="./image/sample-img.jpg" alt="result-category-products">
                    </div>
                    <div class="result-purchase mt-5">
                        <button type="button" class="btn btn-lg btn-purchase" onclick="goPurchase();">카카오톡으로 3초 만에 구매하기</button>
                    </div>
                    <div class="result-event text-center mt-5">
                        <div class="result-event-info">
                            <!-- 이벤트 관련 정보를 넣는 곳 
                                : 텍스트, 광고용 카드 등 자유로운 형태로 삽입 가능 -->
                        </div>
                        <div class="result-event-join text-center mt-2">
                            <h3>이벤트 참여하기!</h3>
                            <div class="btnBox">
                                <button type="button" class="btn btn-outline-primary popOpenBtnCmmn" data-num="1">생일 축하해요!</button>
                                <button type="button" class="btn btn-outline-primary popOpenBtnCmmn" data-num="2">사랑해요!</button>
                                <button type="button" class="btn btn-outline-primary popOpenBtnCmmn" data-num="3">감사해요!</button>
                                <button type="button" class="btn btn-outline-primary popOpenBtnCmmn" data-num="4">건강하세요!</button>
                            </div>
                            <div id="popUp_1" class="popCmmn">
                                <div class="popBg" data-num="1"></div>
                                <div class="popInnerBox">
                                    <div class="popHead">팝업1의 제목입니다.</div>
                                    <div class="popBody">팝업1의 내용입니다.</div>
                                    <div class="popFoot">
                                        <button class="popCloseBtnCmmn" type="button" data-num="1">확인</button>
                                    </div>
                                </div>
                            </div>
                            <div id="popUp_2" class="popCmmn">
                                <div class="popBg" data-num="2"></div>
                                <div class="popInnerBox">
                                    <div class="popHead">팝업2의 제목입니다.</div>
                                    <div class="popBody">팝업2의 내용입니다.</div>
                                    <div class="popFoot">
                                        <button class="popCloseBtnCmmn" type="button" data-num="2">확인</button>
                                    </div>
                                </div>
                            </div>
                            <div id="popUp_3" class="popCmmn">
                                <div class="popBg" data-num="3"></div>
                                <div class="popInnerBox">
                                    <div class="popHead">팝업3의 제목입니다.</div>
                                    <div class="popBody">팝업3의 내용입니다.</div>
                                    <div class="popFoot">
                                        <button class="popCloseBtnCmmn" type="button" data-num="3">확인</button>
                                    </div>
                                </div>
                            </div>
                            <div id="popUp_4" class="popCmmn">
                                <div class="popBg" data-num="4"></div>
                                <div class="popInnerBox">
                                    <div class="popHead">팝업4의 제목입니다.</div>
                                    <div class="popBody">팝업4의 내용입니다.</div>
                                    <div class="popFoot">
                                        <button class="popCloseBtnCmmn" type="button" data-num="4">확인</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </article>

        <script type="text/javascript" src="./js/question.js"></script>
        <script type="text/javascript" src="./js/solution.js"></script>
        <script type="text/javascript" >
            $(".survey").hide(); // 메인 페이지에 등장하지 않도록 숨김 처리
            $(".result").hide();

            var num = 1;

            function start(){
                $(".start").hide();
                $(".survey").show();
                next();
            }

            function result(){
                var name = localStorage.getItem("name");
                var sex = localStorage.getItem("sex");
                var age = localStorage.getItem("age");
                var category = localStorage.getItem("category");

                $(".name").html(name);
                $(".sex").html(sex);
                $(".age").html(age);
                $(".category").html(category);

                if(category == "눈"){
                    $("#result-category-products").attr("src", "image/"+c2.products);
                }
                else if(category == "두뇌 활동"){
                    $("#result-category-products").attr("src", "image/"+c3.products);
                }
                else if(category == "피로/간"){
                    $("#result-category-products").attr("src", "image/"+c4.products);
                }
                else if(category == "체지방/운동능력"){
                    $("#result-category-products").attr("src", "image/"+c5.products);
                }
                else if(category == "피부 관리"){
                    $("#result-category-products").attr("src", "image/"+c6.products);
                }
                else if(category == "뼈/관절"){
                    $("#result-category-products").attr("src", "image/"+c7.products);
                }
                else if(category == "여성 건강(갱년기)"){
                    $("#result-category-products").attr("src", "image/"+c8.products);
                }
                else if(category == "치아/잇몸"){
                    $("#result-category-products").attr("src", "image/"+c9.products);
                }
                else{
                    $("#result-category-products").attr("src", "image/"+c1.products);
                }
            }

            function btnNext(){
                saveAnswer();
                deselect();
                next();
            }

            function answerCheck(){
                if(num == 1){
                    var result = $("input[type=text]").val();
                    if(!result){
                        $(".survey-errormsg").attr("style", "display: ");
                    }
                    else{
                        btnNext();
                    }
                }
                else {
                    if($("input:radio[name='question-answer']").is(":checked") == false){
                        $(".survey-errormsg").attr("style", "display: ");
                    }
                    else{
                        btnNext();
                    }
                }
            }

            $("#btn-next").click(function() {
                if(num < 6){
                    answerCheck();
                }

                if(num == 6){
                        $(".survey").hide();
                        $(".result").show();
                        result();
                }
            });

            function deselect(){
                $("input:radio[name='question-answer']").prop("checked", false);
                $(".survey-errormsg").attr("style", "display: none");
                num++;
            }

            function recommendCategory(){
                var age = localStorage.getItem("age");
                var sex = localStorage.getItem("sex");
                var category = "";

                if(age == "청소년(10대)"){
                    category = "A1MF";
                }
                else if(age == "청년(20-30대)"){
                    category = "A2MF";
                }
                else if(age == "중장년(40-50대)"){
                    if(sex == "남성"){
                        category = "A3M"
                    }

                    if(sex == "여성"){
                        category = "A3F"
                    } 
                }
                else {
                    category = "A4MF"
                }

                return category
            }

            function visibility(){
                var x = q[num]["selectionNum"];

                if(x==0){
                    $(".question-answer-selection").attr("style", "display: none");
                }

                else{
                    $(".question-answer-input").attr("style", "display: none");
                    $(".question-answer-selection").attr("style", "display: ");

                    if(x == 2){
                        $("#C").attr("style", "display: none");
                        $("#D").attr("style", "display: none");
                        $("#E").attr("style", "display: none");
                    }

                    if(x == 3){
                        $("#C").attr("style", "display: ");
                        $("#D").attr("style", "display: none");
                        $("#E").attr("style", "display: none");
                    }

                    if(x == 4){
                        $("#C").attr("style", "display: ");
                        $("#D").attr("style", "display: ");
                        $("#E").attr("style", "display: none");
                    }

                    if(x == 5){
                        $("#C").attr("style", "display: ");
                        $("#D").attr("style", "display: ");
                        $("#E").attr("style", "display: ");
                    }
                }
            }

            function next(){
                // 프로그레스 바 진행 현황 변경
                $("#survey-progress-rate").attr("style", "width:calc(100/5*"+num+"%)");
                
                $("#qNum").text("질문 "+num);

                if(num == 1){
                    $("#qTitle").html(q[num]["title"]);
                    visibility();
                }

                if(num == 2 || num == 3 || num == 5){
                    $("#qTitle").html(q[num]["title"]);

                    $("#selection1").html(q[num]["A"]);
                    $("#selection2").html(q[num]["B"]);
                    $("#selection3").html(q[num]["C"]);
                    $("#selection4").html(q[num]["D"]);
                    $("#selection5").html(q[num]["E"]);

                    visibility();
                }

                if(num==4){
                    var receiver = localStorage.getItem("name");
                    $("#qTitle").html(receiver + "님께 " + q[num]["title"]);

                    var division = recommendCategory();

                    q[num]["selectionNum"] = category[division]["answerNum"]

                    $("#selection1").html(category[division]["W1"]);
                    $("#selection2").html(category[division]["W2"]);
                    $("#selection3").html(category[division]["W3"]);
                    $("#selection4").html(category[division]["W4"]);
                    $("#selection5").html(category[division]["W5"]);

                    visibility();
                }
            }

            function saveAnswer(){
                var key = q[num]["question-type"];

                if(num == 1){
                    var receiver = $(".name").val();
                    localStorage.setItem(key, receiver);
                }
                else{
                    if($("input:radio[name='question-answer']").is(":checked")){
                        var radioID = $("input[name='question-answer']:checked").val();
                        var radioNm = $("label[for='"+radioID+"']").text();
                        localStorage.setItem(key, radioNm);
                    }
                }
            }    


            function goPurchase(){
                let giftCategory = localStorage.getItem("category");
                let giftPrice = localStorage.getItem("price");

                if(giftCategory == "눈"){
                    if(giftPrice == "전체"){
                        location.href = c2.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c2.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c2.L;
                    }  
                }
                
                else if(giftCategory == "두뇌 활동"){
                    if(giftPrice == "전체"){
                        location.href = c3.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c3.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c3.L;
                    }  
                }

                else if(giftCategory == "피로/간"){
                    if(giftPrice == "전체"){
                        location.href = c4.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c4.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c4.L;
                    }  
                }

                else if(giftCategory == "체지방/운동능력"){
                    if(giftPrice == "전체"){
                        location.href = c5.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c5.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c5.L;
                    }  
                }

                else if(giftCategory == "피부 관리"){
                    if(giftPrice == "전체"){
                        location.href = c6.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c6.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c6.L;
                    }  
                }

                else if(giftCategory == "뼈/관절"){
                    if(giftPrice == "전체"){
                        location.href = c7.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c7.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c7.L;
                    }  
                }

                else if(giftCategory == "여성 건강(갱년기)"){
                    if(giftPrice == "전체"){
                        location.href = c8.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c8.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c8.L;
                    }  
                }

                else if(giftCategory == "치아/잇몸"){
                    if(giftPrice == "전체"){
                        location.href = c9.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c9.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c9.L;
                    }  
                }
                
                else{
                    console.log(c1);
                    if(giftPrice == "전체"){
                        location.href = c1.T;
                    }
                    if(giftPrice == "10만원 이상"){
                        // location.href = c1.H;
                    }
                    if(giftPrice == "10만원 미만"){
                        // location.href = c1.L;
                    }
                }
            }
        </script>
        <script type="text/javascript">
            window.onload(setPop());

            // 팝업 세팅
            function setPop() {
                var popOpenBtn = $('.popOpenBtnCmmn');

                //팝업 열기
                $('.popBg, .popOpenBtn').on('click',function(){
                    var clickNum = $(this).attr('data-num');
                    
                    $('#popUp_'+clickNum).fadeIn(200);
                })

                //팝업 닫기
                $('.popBg, .popCloseBtnCmmn').on('click',function(){
                    var clickNum = $(this).attr('data-num');
                    
                    $('#popUp_'+clickNum).fadeOut(200);
                })
            }
        </script>

        <!-- 카카오 메시지 API 관련 -->
        <!-- 내용 변경 필요 -->
        <script type="text/javascript">
            const kakao = () => {
                var mbti = "";

                ($("#EI").val() < 2) ? mbti+="I" : mbti+="E";
                ($("#SN").val() < 2) ? mbti+="N" : mbti+="S";
                ($("#TF").val() < 2) ? mbti+="F" : mbti+="T";
                ($("#JP").val() < 2) ? mbti+="P" : mbti+="J";

                Kakao.Link.sendCustom({templateId: Number(result[mbti]["kakao-share"])});
                return false;
            }
        </script>
    </body>
</html>